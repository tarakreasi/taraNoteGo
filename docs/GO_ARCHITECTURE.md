# TaraNote Go Architecture

## Overview

TaraNote Go replaces the Laravel backend with a **Go** backend while keeping the **Vue.js** frontend largely untouched. This allows for significantly higher performance, lower memory usage, and single-binary deployment capabilities.

## Core Components

### 1. Web Framework: Fiber
We use [Fiber v2](https://gofiber.io/), an Express-inspired web framework for Go. It was chosen for its speed and familiarity to Node.js/JavaScript developers.
- **Router**: Handles all HTTP requests (`cmd/server/main.go`).
- **Middleware**: `internal/middleware/auth.go` protects routes by checking session validity.

### 2. Database: GORM & SQLite
We use [GORM](https://gorm.io/) as the ORM to interact with the SQLite database.
- **Driver**: `go-sqlite3` (requires CGO).
- **Models**: Located in `internal/models/`.
    - `User`: Auth & Profile.
    - `Notebook`: Categorization (Self-referencing logic simplified).
    - `Note`: Core content (Markdown/HTML).
    - `Setting`: Key-Value system store.

### 3. Frontend Integration: Inertia.js
Instead of a REST API consuming JSON, we use **Inertia.js** to serve a modern monolithic SPA.
- **Adapter**: A custom helper in `internal/utils/inertia.go` mocks the behavior of the Laravel Inertia adapter.
- **Protocol**: The server returns JSON objects containing `component` (Vue component name), `props` (Data), `url`, and `version` via the `X-Inertia` header mechanism or embedded in the initial HTML load.
- **Views**: The root HTML template is `views/app.html`, rendered by Fiber's `html/v2` engine.

## Directory Layout

| Directory | Purpose |
| :--- | :--- |
| **`cmd/`** | Application entry points. `server` for the web app, `migrate` for DB schema tools. |
| **`internal/`** | Private application code. Not importable by other projects. |
| **`internal/handlers`** | Controller logic. Contains `auth.go`, `notebook.go`, `note.go`, `public.go`. |
| **`internal/models`** | Struct definitions and database tags (`gorm:"..."`). |
| **`resources/`** | The raw frontend source code (Vue, JS, CSS). Identical to Laravel structure. |
| **`public/`** | The web root. Contains `build/` assets generated by Vite and `uploads/`. |

## Key Differences from Laravel

1.  **Routing**: Routes are defined in `main.go`, not `routes/web.php`.
2.  **Named Routes**: We do NOT use Ziggy (Laravel's JS route helper) currently. Routes in Vue must be hardcoded or managed via a JS object.
3.  **Migrations**: We use GORM's `AutoMigrate` in `cmd/migrate/main.go` instead of timestamped migration files.
4.  **Session**: Stored in memory (cookies) by default. Can be switched to Redis in `internal/config/session.go`.

## Future Improvements

- [ ] **Redis Caching**: For sessions and heavy queries.
- [ ] **CLI Tool**: A proper CLI for managing users (make admin, reset password).
- [ ] **Testing**: Add `_test.go` files for handlers and models.
- [ ] **Full Ziggy Support**: Implement a JSON generator to pass route definitions to the frontend.
