import{m as l,p as G,q as V,k as K,f as F,a as y,b as d,u as Q,Z,c as P,g as j,o as N}from"./app-EZ_mEjBi.js";import{u as H,_ as J}from"./FloatingDock-CjwUH8JT.js";import W from"./SettingsPanel-Dm3AUNMO.js";import X from"./Sidebar-CD9LaHlp.js";import Y from"./NoteList-Dc2OHEIH.js";import ee from"./EditorSection-DSCkzyvO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"min-h-screen bg-slate-50 dark:bg-[#0B1121] transition-colors duration-300 relative overflow-hidden flex flex-col h-screen"},ae={class:"relative z-10 flex w-full h-full max-w-[1920px] mx-auto overflow-hidden"},te={key:1,class:"flex-1 flex flex-col bg-white/50 dark:bg-[#0F172A]/50 relative transition-all duration-300 backdrop-blur-sm"},ve={__name:"Dashboard",setup(ne){const u=l([]),p=l([]),h=l(!0),x=l(!0),_=l(null),w=l(""),b=l("ALL"),r=l(null),c=l("EDITOR"),s=l(null),n=l(""),v=async()=>{x.value=!0;try{const e=await window.axios.get("/api/v1/admin/notes",{params:{search:w.value,status:b.value!=="ALL"?b.value:null,notebook_id:r.value}});u.value=e.data.data}catch(e){console.error("Error fetching notes:",e)}finally{x.value=!1}},m=async()=>{h.value=!0;try{const e=await window.axios.get("/api/v1/admin/notebooks");p.value=e.data.data.sort((o,t)=>o.id-t.id)}catch(e){console.error("Error fetching notebooks:",e),h.value=!1}finally{h.value=!1}};let S=null;G(w,()=>{clearTimeout(S),S=setTimeout(()=>v(),500)});const R=e=>{b.value=e,v()},T=e=>{r.value=e,v()};V(()=>{m(),v(),new URLSearchParams(window.location.search).get("view")==="settings"&&(c.value="SETTINGS",s.value=null)});const O=async e=>{try{await window.axios.post("/api/v1/admin/notebooks",{name:e}),await m()}catch(o){console.error(o),alert("Failed to create space")}},$=async({id:e,type:o,value:t})=>{try{o==="NOTEBOOK_NAME"?await window.axios.put(`/api/v1/admin/notebooks/${e}`,{name:t}):o==="NOTEBOOK_SLUG"&&await window.axios.put(`/api/v1/admin/notebooks/${e}`,{slug:t}),await m()}catch(a){console.error("Failed to rename notebook:",a),alert("Failed to save changes.")}},I=async e=>{var o,t;try{await window.axios.delete(`/api/v1/admin/notebooks/${e}`),await m(),r.value===e&&T(null)}catch(a){console.error(a),alert(((t=(o=a.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to delete space.")}},E=()=>{_.value&&_.value.startCreatingSpace()},L=async()=>{const e=r.value||(p.value.length>0?p.value[0].id:null);try{const o=await window.axios.post("/api/v1/admin/notes",{title:"Untitled Page",notebook_id:e,content:"",status:"DRAFT"});v(),s.value=o.data.data}catch(o){console.error(o),alert("Failed to create page")}},B=async({id:e,type:o,value:t})=>{var a;try{const f=o==="NOTE_TITLE"?{title:t}:{slug:t},i=(await window.axios.patch(`/api/v1/admin/notes/${e}`,f)).data.data,k=u.value.findIndex(M=>M.id===i.id);k!==-1&&(u.value[k]=i),((a=s.value)==null?void 0:a.id)===i.id&&(s.value=i)}catch(f){console.error("Failed to rename note:",f),alert("Failed to save changes.")}},D=e=>{s.value=e,n.value=""},U=async({data:e,isAutoSave:o})=>{var t;n.value="Saving...";try{const a=new FormData;a.append("title",e.title||"Untitled Page"),a.append("content",e.content||""),e.notebook_id&&a.append("notebook_id",e.notebook_id),a.append("status",e.status),a.append("_method","PUT"),a.append("is_featured",e.is_featured?"1":"0"),e.cover_image&&a.append("cover_image",e.cover_image);const f=await window.axios.post(`/api/v1/admin/notes/${e.id}`,a,{headers:{"Content-Type":"multipart/form-data"}});n.value="Saved";const g=f.data.data,i=u.value.findIndex(k=>k.id===g.id);i!==-1&&(u.value[i]=g),((t=s.value)==null?void 0:t.id)===g.id&&(s.value=g),o&&setTimeout(()=>{n.value==="Saved"&&(n.value="")},2e3)}catch(a){console.error("Error saving note:",a),n.value="Error",o||alert("Failed to save note")}},C=async e=>{var o;try{await window.axios.delete(`/api/v1/admin/notes/${e}`),((o=s.value)==null?void 0:o.id)===e&&(s.value=null),v(),m()}catch(t){console.error("Delete failed:",t),alert("Failed to delete")}},q=async e=>{n.value="Saving Profile...";try{const o={name:e.name,username:e.username,email:e.email,bio:e.bio,hero_tagline:e.hero_tagline,avatar:e.avatar,hero_image:e.hero_image};await window.axios.patch(route("profile.update"),o),n.value="Profile Saved"}catch(o){console.error("Profile save failed:",o),n.value="Error Saving Profile",alert("Failed to save profile.")}finally{setTimeout(()=>{n.value==="Profile Saved"&&(n.value="")},3e3)}},A=K(()=>{var e;return r.value&&((e=p.value.find(o=>o.id===r.value))==null?void 0:e.name)||"All Notes"});H();const z={backgroundImage:`url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.5'/%3E%3C/svg%3E")`};return(e,o)=>{var t;return N(),F("div",null,[y(Q(Z),{title:"Dashboard"}),y(J),d("div",oe,[o[3]||(o[3]=d("img",{src:"/images/logo_tarakreasi.png",class:"fixed bottom-6 right-6 h-16 w-auto z-[100] pointer-events-none transition-all duration-300 dark:bg-white dark:rounded-xl dark:p-2 dark:shadow-lg shadow-sm opacity-90 hover:opacity-100"},null,-1)),d("div",{class:"fixed inset-0 z-0 opacity-[0.03] dark:opacity-[0.02] pointer-events-none",style:z}),o[4]||(o[4]=d("div",{class:"fixed inset-0 overflow-hidden pointer-events-none z-0",style:{"background-image":"radial-gradient(circle at 50% 0%, rgba(99, 102, 241, 0.03) 0%, transparent 50%)"}},[d("div",{class:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-500/5 blur-[120px] rounded-full animate-pulse"}),d("div",{class:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-rose-500/5 blur-[120px] rounded-full animate-pulse",style:{"animation-delay":"2s"}})],-1)),d("div",ae,[y(X,{ref_key:"sidebarRef",ref:_,notebooks:p.value,"selected-notebook-id":r.value,"view-mode":c.value,"notebooks-loading":h.value,"onUpdate:viewMode":o[0]||(o[0]=a=>c.value=a),onSelectNotebook:T,onCreateNotebook:O,onRenameNotebook:$,onDeleteNotebook:I},null,8,["notebooks","selected-notebook-id","view-mode","notebooks-loading"]),c.value==="EDITOR"?(N(),P(Y,{key:0,notes:u.value,"selected-note-id":(t=s.value)==null?void 0:t.id,"search-query":w.value,"filter-status":b.value,"current-notebook-name":A.value,"is-loading":x.value,"onUpdate:searchQuery":o[1]||(o[1]=a=>w.value=a),"onUpdate:filterStatus":R,onSelectNote:D,onCreatePage:L,onRequestCreateSpace:E,onRenameNote:B,onDeleteNote:C},null,8,["notes","selected-note-id","search-query","filter-status","current-notebook-name","is-loading"])):j("",!0),c.value==="SETTINGS"?(N(),F("main",te,[y(W,{user:e.$page.props.auth.user,"save-status":n.value,onClose:o[2]||(o[2]=a=>c.value="EDITOR"),onSaveProfile:q},null,8,["user","save-status"])])):(N(),P(ee,{key:2,note:s.value,"save-status":n.value,onSave:U,onDelete:C,onRequestCreateSpace:E},null,8,["note","save-status"]))])])])}}};export{ve as default};
